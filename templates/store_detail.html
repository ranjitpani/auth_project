{% extends "base.html" %}
{% load static %}
{% block title %}{{ store.name }}{% endblock %}

{% block content %}
<h2 style="text-align:center; margin-bottom:15px;">{{ store.name }}</h2>
<div style="text-align:center; margin-bottom:20px;">
    {% if store.image %}
        <img src="{{ store.image.url }}" style="width:100%; max-height:300px; object-fit:cover; border-radius:8px;">
    {% else %}
        <img src="{% static 'default_store.jpg' %}" style="width:100%; max-height:300px; object-fit:cover; border-radius:8px;">
    {% endif %}
</div>
<p>{{ store.details }}</p>
<hr>

{% comment %} Category-wise product display {% endcomment %}
{% for category, cat_products in products_by_category.items %}
    <h3 style="margin-top:20px;">{{ category }}</h3>
    <div style="display:flex; gap:10px; overflow-x:auto; padding-bottom:10px;">
        {% for product in cat_products %}
        <a href="{% url 'product_detail' product.id %}" style="text-decoration:none; color:inherit;">
            <div style="min-width:180px; border:1px solid #ddd; padding:10px; border-radius:6px; background:#fff; position:relative;">
                {% if product.image_url %}
    <img src="{{ product.image_url }}" style="width:100%; height:150px; object-fit:cover;">
{% elif product.image %}
    <img src="{{ product.image.url }}" style="width:100%; height:150px; object-fit:cover;">
{% else %}
    <img src="{% static 'default_product.jpg' %}">
{% endif %}

                <h4 style="margin:0; font-size:14px;">{{ product.name|truncatechars:20 }}</h4>

                <div style="margin-top:4px; font-size:13px; display:flex; justify-content:space-between; align-items:center;">
                    {% if product.discounted_price %}
                        <span style="text-decoration: line-through; color: #888;">₹ {{ product.price }}</span>
                        <span style="font-weight:bold; color:#e60023;">₹ {{ product.discounted_price }}</span>
                        <span style="background:#e60023; color:#fff; font-size:10px; padding:2px 4px; border-radius:3px;">
                            -{{ product.discount_percentage }}%
                        </span>
                    {% else %}
                        <span style="font-weight:bold;">₹ {{ product.price }}</span>
                    {% endif %}
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
{% endfor %}
{% endblock %}