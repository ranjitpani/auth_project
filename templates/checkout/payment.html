{% include "checkout/steps.html" with step=3 %}

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Payment</title>

<style>
/* ---------- BASE ---------- */
*{box-sizing:border-box;}
body{
  margin:0;
  background:linear-gradient(180deg,#eef2ff,#ffffff);
  font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
}

/* ---------- PAGE ---------- */
.page{
  width:100%;
  min-height:100vh;
  padding:16px;
  padding-bottom:120px;
  animation:fadeUp .35s ease;
}
@keyframes fadeUp{
  from{opacity:0;transform:translateY(14px)}
  to{opacity:1;transform:translateY(0)}
}

/* ---------- TITLE ---------- */
h3{
  margin:18px 6px 14px;
  font-size:20px;
  font-weight:900;
  color:#0f172a;
}

/* ---------- CARD ---------- */
.card{
  background:#fff;
  padding:16px;
  border-radius:18px;
  box-shadow:0 10px 26px rgba(0,0,0,.1);
  margin-bottom:14px;
}

/* ---------- PAYMENT OPTION ---------- */
.pay-option{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:18px;
  border-radius:16px;
  border:2px solid #e5e7eb;
  margin-bottom:14px;
  cursor:pointer;
  transition:.2s;
}
.pay-option:hover{
  border-color:#2563eb;
  background:#f5f7ff;
}
.pay-option input{
  display:none;
}
.pay-option.active{
  border-color:#2563eb;
  background:#eef2ff;
}
.pay-left{
  display:flex;
  align-items:center;
  gap:14px;
}
.pay-icon{
  width:44px;
  height:44px;
  border-radius:50%;
  background:#eef2ff;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:20px;
}
.pay-title{
  font-weight:800;
  font-size:16px;
}
.pay-sub{
  font-size:13px;
  color:#64748b;
}

/* ---------- FIXED BOTTOM ---------- */
.fixed-bottom{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  background:#fff;
  padding:14px 16px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  box-shadow:0 -6px 24px rgba(0,0,0,.2);
}
.pay-btn{
  background:linear-gradient(135deg,#16a34a,#15803d);
  color:#fff;
  padding:16px 28px;
  border-radius:20px;
  font-size:16px;
  font-weight:900;
  border:none;
  cursor:pointer;
}
.pay-btn:disabled{
  background:#94a3b8;
}

/* ---------- DESKTOP ---------- */
@media(min-width:768px){
  .page{
    max-width:520px;
    margin:auto;
  }
}
</style>
</head>

<body>

<div class="page">

<!-- ORDER SUMMARY -->
<div class="card">
  <h4 style="margin:0 0 12px;font-size:16px;">Order Summary</h4>

  {% for item in cart_items %}
  <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
    <span>{{ item.product.name }} Ã— {{ item.quantity }}</span>
    <b>â‚¹ {{ item.total_price }}</b>
  </div>
  {% endfor %}

  <hr style="margin:10px 0;">

  <div style="display:flex;justify-content:space-between;">
    <span>Subtotal</span>
    <b>â‚¹ {{ subtotal }}</b>
  </div>

   <!-- ðŸ”¥ DELIVERY BREAKUP -->
  <!-- ðŸ”¥ DELIVERY BREAKUP -->
<div style="display:flex;justify-content:space-between;">
  <span>Product Delivery</span>
  <b>â‚¹ {{ product_delivery_total }}</b>
</div>

<div style="display:flex;justify-content:space-between;">
  <span>Distance Delivery</span>
  <b>â‚¹ {{ km_delivery_total }}</b>
</div>

<div style="display:flex;justify-content:space-between;font-weight:800;">
  <span>Total Delivery</span>
  <b>â‚¹ {{ delivery_charge }}</b>
</div>

  <hr>

  <div style="display:flex;justify-content:space-between;font-size:17px;">
    <b>Total Payable</b>
    <b style="color:#15803d;">â‚¹ {{ total_amount }}</b>
  </div>
</div>   

<h3>Select Payment Method</h3>

<form method="post" action="{% url 'place_order' %}">
{% csrf_token %}

<!-- UPI -->
<label class="pay-option" onclick="selectPay(this)">
  <div class="pay-left">
    <div class="pay-icon">ðŸ“±</div>
    <div>
      <div class="pay-title">UPI</div>
      <div class="pay-sub">PhonePe, GPay, Paytm</div>
    </div>
  </div>
  <input type="radio" name="payment_method" value="upi">
</label>

<!-- CARD -->
<label class="pay-option" onclick="selectPay(this)">
  <div class="pay-left">
    <div class="pay-icon">ðŸ’³</div>
    <div>
      <div class="pay-title">Debit / Credit Card</div>
      <div class="pay-sub">Visa, MasterCard</div>
    </div>
  </div>
  <input type="radio" name="payment_method" value="card">
</label>

<!-- COD -->
<label class="pay-option" onclick="selectPay(this)">
  <div class="pay-left">
    <div class="pay-icon">ðŸ’µ</div>
    <div>
      <div class="pay-title">Cash on Delivery</div>
      <div class="pay-sub">Pay when item delivered</div>
    </div>
  </div>
  <input type="radio" name="payment_method" value="cod">
</label>

<!-- FIXED -->
<div class="fixed-bottom">
  <div>
    <small>Total Payable</small><br>
    <b style="font-size:19px; color: #15803d;">â‚¹ {{ total_amount }}</b>
  </div>
  <button type="submit" class="pay-btn" id="payBtn" disabled>
    Place Order â†’
  </button>
</div>

</form>
</div>

<script>
function selectPay(el){
  document.querySelectorAll('.pay-option')
    .forEach(e=>e.classList.remove('active'));

  el.classList.add('active');
  el.querySelector('input').checked = true;

  document.getElementById('payBtn').disabled = false;
}
</script>

</body>
</html>