{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Order Summary</title>
<style>
*{box-sizing:border-box;}
body{
  margin:0;
  background:#f4f6fb;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
}
.page{
  width:100%;
  padding:14px;
  padding-bottom:120px;
  animation:fadeUp .3s ease;
}
@keyframes fadeUp{
  from{opacity:0;transform:translateY(12px)}
  to{opacity:1;transform:translateY(0)}
}
h4{
  margin:16px 4px 10px;
  font-size:17px;
  font-weight:800;
  color:#0f172a;
}
.box{
  width:100%;
  background:#fff;
  padding:16px;
  border-radius:16px;
  margin-bottom:14px;
  box-shadow:0 10px 22px rgba(0,0,0,.08);
}
.address-name{
  font-weight:800;
  font-size:16px;
}
.change-link{
  display:inline-block;
  margin-top:10px;
  color:#2563eb;
  font-weight:700;
  text-decoration:none;
}
.product-box{
  display:flex;
  gap:14px;
}
.product-box img{
  width:96px;
  height:96px;
  object-fit:cover;
  border-radius:14px;
  background:#f1f5f9;
}
.price-row{
  display:flex;
  justify-content:space-between;
  font-size:15px;
  margin-bottom:8px;
}
.price-row.discount{
  color:#16a34a;
}
.total{
  font-size:18px;
  font-weight:900;
}
.fixed-bottom{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  background:#fff;
  padding:14px 16px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  box-shadow:0 -6px 22px rgba(0,0,0,.18);
  z-index:99;
}
.pay-btn{
  background:linear-gradient(135deg,#2563eb,#1e40af);
  color:#fff;
  padding:16px 26px;
  border-radius:18px;
  text-decoration:none;
  font-weight:800;
  font-size:16px;
}
@media(min-width:768px){
  .page{
    max-width:520px;
    margin:20px auto;
  }
}
</style>
</head>
<body>

{% include "checkout/steps.html" with step=2 %}

<div class="page">

<h4>Deliver To</h4>
<div class="box">
  <div class="address-name">{{ address.name }}</div>
  <div style="margin-top:6px;">
    {{ address.address|linebreaksbr }}<br>
    <b>Pincode:</b> {{ address.pincode }}<br>
    <b>State:</b> {{ address.state }}<br>
    <b>District:</b> {{ address.district }}<br>
    <b>Village/Block:</b> {{ address.block }}
  </div>
  <div style="margin-top:8px;">ðŸ“ž {{ address.mobile }}</div>
  <a class="change-link" href="{% url 'checkout_address' %}">
    Change / Edit Address â†’
  </a>
</div>

<h4>Products</h4>
{% for item in items %}
<div class="box product-box">
  {% if item.product.image %}
    <img src="{{ item.product.image.url }}">
{% elif item.product.images.first %}
    <img src="{{ item.product.images.first.image.url }}">
{% else %}
    <img src="{% static 'default_product.jpg' %}">
{% endif %}
  <div>
    <b>{{ item.product.name }}</b><br>
    Size: {{ item.size }}<br>
    Qty: {{ item.qty }}<br>
    <b>â‚¹ {{ item.price }}</b>
  </div>
</div>
{% endfor %}

<h4>Price Details</h4>
<div class="box">
  <div class="price-row">
    <span>Price ({{ items|length }} items)</span>
    <span>â‚¹ {{ original_price }}</span>
  </div>

  <div class="price-row discount">
    <span>Discount</span>
    <span>- â‚¹ {{ discount }}</span>
  </div>

  <!-- ðŸ”¥ DELIVERY CHARGE -->
  <div class="price-row">
    <span>Delivery Charges</span>
    <span>â‚¹ {{ delivery_charge }}</span>
  </div>

  <hr>

  <div class="price-row total">
    <span>Total Amount</span>
    <span>â‚¹ {{ total_amount }}</span>
  </div>
</div>
</div>

<div class="fixed-bottom">
  <div>
    <small>Total</small><br>
    <b style="font-size:19px; color: #16a34a;">â‚¹ {{ total_amount }}</b>
  </div>
  <a href="{% url 'checkout_payment' %}" class="pay-btn">
    Continue â†’
  </a>
</div>

</body>
</html>